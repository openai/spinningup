

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Running Experiments &mdash; Spinning Up  documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/openai_icon.ico"/>
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/modify.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Experiment Outputs" href="saving_and_loading.html" />
    <link rel="prev" title="Algorithms" href="algorithms.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/spinning-up-logo2.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">User Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Algorithms</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running Experiments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#launching-from-the-command-line">Launching from the Command Line</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-hyperparameters-from-the-command-line">Setting Hyperparameters from the Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launching-multiple-experiments-at-once">Launching Multiple Experiments at Once</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-flags">Special Flags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#environment-flag">Environment Flag</a></li>
<li class="toctree-l4"><a class="reference internal" href="#shortcut-flags">Shortcut Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#config-flags">Config Flags</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#where-results-are-saved">Where Results are Saved</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-is-suffix-determined">How is Suffix Determined?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#extra">Extra</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#launching-from-scripts">Launching from Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-experimentgrid">Using ExperimentGrid</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="saving_and_loading.html">Experiment Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting Results</a></li>
</ul>
<p class="caption"><span class="caption-text">Introduction to RL</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../spinningup/rl_intro.html">Part 1: Key Concepts in RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spinningup/rl_intro2.html">Part 2: Kinds of RL Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spinningup/rl_intro3.html">Part 3: Intro to Policy Optimization</a></li>
</ul>
<p class="caption"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../spinningup/spinningup.html">Spinning Up as a Deep RL Researcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spinningup/keypapers.html">Key Papers in Deep RL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spinningup/exercises.html">Exercises</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spinningup/bench.html">Benchmarks for Spinning Up Implementations</a></li>
</ul>
<p class="caption"><span class="caption-text">Algorithms Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/vpg.html">Vanilla Policy Gradient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/trpo.html">Trust Region Policy Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/ppo.html">Proximal Policy Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/ddpg.html">Deep Deterministic Policy Gradient</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/td3.html">Twin Delayed DDPG</a></li>
<li class="toctree-l1"><a class="reference internal" href="../algorithms/sac.html">Soft Actor-Critic</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/logger.html">Logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/plotter.html">Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/mpi.html">MPI Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/run_utils.html">Run Utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../etc/acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../etc/author.html">About the Author</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Spinning Up</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Running Experiments</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/user/running.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="running-experiments">
<h1><a class="toc-backref" href="#id3">Running Experiments</a><a class="headerlink" href="#running-experiments" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#running-experiments" id="id3">Running Experiments</a><ul>
<li><a class="reference internal" href="#launching-from-the-command-line" id="id4">Launching from the Command Line</a><ul>
<li><a class="reference internal" href="#setting-hyperparameters-from-the-command-line" id="id5">Setting Hyperparameters from the Command Line</a></li>
<li><a class="reference internal" href="#launching-multiple-experiments-at-once" id="id6">Launching Multiple Experiments at Once</a></li>
<li><a class="reference internal" href="#special-flags" id="id7">Special Flags</a><ul>
<li><a class="reference internal" href="#environment-flag" id="id8">Environment Flag</a></li>
<li><a class="reference internal" href="#shortcut-flags" id="id9">Shortcut Flags</a></li>
<li><a class="reference internal" href="#config-flags" id="id10">Config Flags</a></li>
</ul>
</li>
<li><a class="reference internal" href="#where-results-are-saved" id="id11">Where Results are Saved</a><ul>
<li><a class="reference internal" href="#how-is-suffix-determined" id="id12">How is Suffix Determined?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#extra" id="id13">Extra</a></li>
</ul>
</li>
<li><a class="reference internal" href="#launching-from-scripts" id="id14">Launching from Scripts</a><ul>
<li><a class="reference internal" href="#using-experimentgrid" id="id15">Using ExperimentGrid</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>One of the best ways to get a feel for deep RL is to run the algorithms and see how they perform on different tasks. The Spinning Up code library makes small-scale (local) experiments easy to do, and in this section, we&#8217;ll discuss two ways to run them: either from the command line, or through function calls in scripts.</p>
<div class="section" id="launching-from-the-command-line">
<h2><a class="toc-backref" href="#id4">Launching from the Command Line</a><a class="headerlink" href="#launching-from-the-command-line" title="Permalink to this headline">¶</a></h2>
<p>Spinning Up ships with <code class="docutils literal"><span class="pre">spinup/run.py</span></code>, a convenient tool that lets you easily launch any algorithm (with any choices of hyperparameters) from the command line. It also serves as a thin wrapper over the utilities for watching trained policies and plotting, although we will not discuss that functionality on this page (for those details, see the pages on <a class="reference external" href="../user/saving_and_loading.html">experiment outputs</a> and <a class="reference external" href="../user/plotting.html">plotting</a>).</p>
<p>The standard way to run a Spinning Up algorithm from the command line is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spinup</span><span class="o">.</span><span class="n">run</span> <span class="p">[</span><span class="n">algo</span> <span class="n">name</span><span class="p">]</span> <span class="p">[</span><span class="n">experiment</span> <span class="n">flags</span><span class="p">]</span>
</pre></div>
</div>
<p>eg:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spinup</span><span class="o">.</span><span class="n">run</span> <span class="n">ppo</span> <span class="o">--</span><span class="n">env</span> <span class="n">Walker2d</span><span class="o">-</span><span class="n">v2</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">walker</span>
</pre></div>
</div>
<div class="admonition-you-should-know admonition">
<p class="first admonition-title">You Should Know</p>
<p class="last">If you are using ZShell: ZShell interprets square brackets as special characters. Spinning Up uses square brackets in a few ways for command line arguments; make sure to escape them, or try the solution recommended <a class="reference external" href="http://kinopyo.com/en/blog/escape-square-bracket-by-default-in-zsh">here</a> if you want to escape them by default.</p>
</div>
<div class="admonition-detailed-quickstart-guide admonition">
<p class="first admonition-title">Detailed Quickstart Guide</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spinup</span><span class="o">.</span><span class="n">run</span> <span class="n">ppo</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">ppo_ant</span> <span class="o">--</span><span class="n">env</span> <span class="n">Ant</span><span class="o">-</span><span class="n">v2</span> <span class="o">--</span><span class="n">clip_ratio</span> <span class="mf">0.1</span> <span class="mf">0.2</span>
    <span class="o">--</span><span class="n">hid</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">]</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span><span class="mi">32</span><span class="p">]</span> <span class="o">--</span><span class="n">act</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">tanh</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="o">--</span><span class="n">dt</span>
    <span class="o">--</span><span class="n">data_dir</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span>
</pre></div>
</div>
<p>runs PPO in the <code class="docutils literal"><span class="pre">Ant-v2</span></code> Gym environment, with various settings controlled by the flags.</p>
<p><code class="docutils literal"><span class="pre">clip_ratio</span></code>, <code class="docutils literal"><span class="pre">hid</span></code>, and <code class="docutils literal"><span class="pre">act</span></code> are flags to set some algorithm hyperparameters. You can provide multiple values for hyperparameters to run multiple experiments. Check the docs to see what hyperparameters you can set (click here for the <a class="reference external" href="../algorithms/ppo.html#spinup.ppo">PPO documentation</a>).</p>
<p><code class="docutils literal"><span class="pre">hid</span></code> and <code class="docutils literal"><span class="pre">act</span></code> are <a class="reference external" href="../user/running.html#shortcut-flags">special shortcut flags</a> for setting the hidden sizes and activation function for the neural networks trained by the algorithm.</p>
<p>The <code class="docutils literal"><span class="pre">seed</span></code> flag sets the seed for the random number generator. RL algorithms have high variance, so try multiple seeds to get a feel for how performance varies.</p>
<p>The <code class="docutils literal"><span class="pre">dt</span></code> flag ensures that the save directory names will have timestamps in them (otherwise they don&#8217;t, unless you set <code class="docutils literal"><span class="pre">FORCE_DATESTAMP=True</span></code> in <code class="docutils literal"><span class="pre">spinup/user_config.py</span></code>).</p>
<p>The <code class="docutils literal"><span class="pre">data_dir</span></code> flag allows you to set the save folder for results. The default value is set by <code class="docutils literal"><span class="pre">DEFAULT_DATA_DIR</span></code> in <code class="docutils literal"><span class="pre">spinup/user_config.py</span></code>, which will be a subfolder <code class="docutils literal"><span class="pre">data</span></code> in the <code class="docutils literal"><span class="pre">spinningup</span></code> folder (unless you change it).</p>
<p><a class="reference external" href="../user/running.html#where-results-are-saved">Save directory names</a> are based on <code class="docutils literal"><span class="pre">exp_name</span></code> and any flags which have multiple values. Instead of the full flag, a shorthand will appear in the directory name. Shorthands can be provided by the user in square brackets after the flag, like <code class="docutils literal"><span class="pre">--hid[h]</span></code>; otherwise, shorthands are substrings of the flag (<code class="docutils literal"><span class="pre">clip_ratio</span></code> becomes <code class="docutils literal"><span class="pre">cli</span></code>). To illustrate, the save directory for the run with <code class="docutils literal"><span class="pre">clip_ratio=0.1</span></code>, <code class="docutils literal"><span class="pre">hid=[32,32]</span></code>, and <code class="docutils literal"><span class="pre">seed=10</span></code> will be:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">YY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD_ppo_ant_cli0</span><span class="o">-</span><span class="mi">1</span><span class="n">_h32</span><span class="o">-</span><span class="mi">32</span><span class="o">/</span><span class="n">YY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD_HH</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">SS</span><span class="o">-</span><span class="n">ppo_ant_cli0</span><span class="o">-</span><span class="mi">1</span><span class="n">_h32</span><span class="o">-</span><span class="mi">32</span><span class="n">_seed10</span>
</pre></div>
</div>
</div>
<div class="section" id="setting-hyperparameters-from-the-command-line">
<h3><a class="toc-backref" href="#id5">Setting Hyperparameters from the Command Line</a><a class="headerlink" href="#setting-hyperparameters-from-the-command-line" title="Permalink to this headline">¶</a></h3>
<p>Every hyperparameter in every algorithm can be controlled directly from the command line. If <code class="docutils literal"><span class="pre">kwarg</span></code> is a valid keyword arg for the function call of an algorithm, you can set values for it with the flag <code class="docutils literal"><span class="pre">--kwarg</span></code>. To find out what keyword args are available, see either the docs page for an algorithm, or try</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spinup</span><span class="o">.</span><span class="n">run</span> <span class="p">[</span><span class="n">algo</span> <span class="n">name</span><span class="p">]</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>to see a readout of the docstring.</p>
<div class="admonition-you-should-know admonition">
<p class="first admonition-title">You Should Know</p>
<p>Values pass through <code class="docutils literal"><span class="pre">eval()</span></code> before being used, so you can describe some functions and objects directly from the command line. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spinup</span><span class="o">.</span><span class="n">run</span> <span class="n">ppo</span> <span class="o">--</span><span class="n">env</span> <span class="n">Walker2d</span><span class="o">-</span><span class="n">v2</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">walker</span> <span class="o">--</span><span class="n">act</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">elu</span>
</pre></div>
</div>
<p class="last">sets <code class="docutils literal"><span class="pre">tf.nn.elu</span></code> as the activation function.</p>
</div>
<div class="admonition-you-should-know admonition">
<p class="first admonition-title">You Should Know</p>
<p>There&#8217;s some nice handling for kwargs that take dict values. Instead of having to provide</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">key</span> <span class="nb">dict</span><span class="p">(</span><span class="n">v1</span><span class="o">=</span><span class="n">value_1</span><span class="p">,</span> <span class="n">v2</span><span class="o">=</span><span class="n">value_2</span><span class="p">)</span>
</pre></div>
</div>
<p>you can give</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">key</span><span class="p">:</span><span class="n">v1</span> <span class="n">value_1</span> <span class="o">--</span><span class="n">key</span><span class="p">:</span><span class="n">v2</span> <span class="n">value_2</span>
</pre></div>
</div>
<p class="last">to get the same result.</p>
</div>
</div>
<div class="section" id="launching-multiple-experiments-at-once">
<h3><a class="toc-backref" href="#id6">Launching Multiple Experiments at Once</a><a class="headerlink" href="#launching-multiple-experiments-at-once" title="Permalink to this headline">¶</a></h3>
<p>You can launch multiple experiments, to be executed <strong>in series</strong>, by simply providing more than one value for a given argument. (An experiment for each possible combination of values will be launched.)</p>
<p>For example, to launch otherwise-equivalent runs with different random seeds (0, 10, and 20), do:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spinup</span><span class="o">.</span><span class="n">run</span> <span class="n">ppo</span> <span class="o">--</span><span class="n">env</span> <span class="n">Walker2d</span><span class="o">-</span><span class="n">v2</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">walker</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span>
</pre></div>
</div>
<p>Experiments don&#8217;t launch in parallel because they soak up enough resources that executing several at the same time wouldn&#8217;t get a speedup.</p>
</div>
<div class="section" id="special-flags">
<h3><a class="toc-backref" href="#id7">Special Flags</a><a class="headerlink" href="#special-flags" title="Permalink to this headline">¶</a></h3>
<p>A few flags receive special treatment.</p>
<div class="section" id="environment-flag">
<h4><a class="toc-backref" href="#id8">Environment Flag</a><a class="headerlink" href="#environment-flag" title="Permalink to this headline">¶</a></h4>
<dl class="option">
<dt id="cmdoption-env">
<code class="descname">--env</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--env_name</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-env" title="Permalink to this definition">¶</a></dt>
<dd><p><em>string</em>. The name of an environment in the OpenAI Gym. All Spinning Up algorithms are implemented as functions that accept <code class="docutils literal"><span class="pre">env_fn</span></code> as an argument, where <code class="docutils literal"><span class="pre">env_fn</span></code> must be a callable function that builds a copy of the RL environment. Since the most common use case is Gym environments, though, all of which are built through <code class="docutils literal"><span class="pre">gym.make(env_name)</span></code>, we allow you to just specify <code class="docutils literal"><span class="pre">env_name</span></code> (or <code class="docutils literal"><span class="pre">env</span></code> for short) at the command line, which gets converted to a lambda-function that builds the correct gym environment.</p>
</dd></dl>

</div>
<div class="section" id="shortcut-flags">
<h4><a class="toc-backref" href="#id9">Shortcut Flags</a><a class="headerlink" href="#shortcut-flags" title="Permalink to this headline">¶</a></h4>
<p>Some algorithm arguments are relatively long, and we enabled shortcuts for them:</p>
<dl class="option">
<dt id="cmdoption-hid">
<code class="descname">--hid</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--ac_kwargs</code><code class="descclassname">:hidden_sizes</code><a class="headerlink" href="#cmdoption-hid" title="Permalink to this definition">¶</a></dt>
<dd><p><em>list of ints</em>. Sets the sizes of the hidden layers in the neural networks (policies and value functions).</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-act">
<code class="descname">--act</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--ac_kwargs</code><code class="descclassname">:activation</code><a class="headerlink" href="#cmdoption-act" title="Permalink to this definition">¶</a></dt>
<dd><p><em>tf op</em>. The activation function for the neural networks in the actor and critic.</p>
</dd></dl>

<p>These flags are valid for all current Spinning Up algorithms.</p>
</div>
<div class="section" id="config-flags">
<h4><a class="toc-backref" href="#id10">Config Flags</a><a class="headerlink" href="#config-flags" title="Permalink to this headline">¶</a></h4>
<p>These flags are not hyperparameters of any algorithm, but change the experimental configuration in some way.</p>
<dl class="option">
<dt id="cmdoption-cpu">
<code class="descname">--cpu</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--num_cpu</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-cpu" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em>. If this flag is set, the experiment is launched with this many processes, one per cpu, connected by MPI. Some algorithms are amenable to this sort of parallelization but not all. An error will be raised if you try setting <code class="docutils literal"><span class="pre">num_cpu</span></code> &gt; 1 for an incompatible algorithm. You can also set <code class="docutils literal"><span class="pre">--num_cpu</span> <span class="pre">auto</span></code>, which will automatically use as many CPUs as are available on the machine.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-exp-name">
<code class="descname">--exp_name</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-exp-name" title="Permalink to this definition">¶</a></dt>
<dd><p><em>string</em>. The experiment name. This is used in naming the save directory for each experiment. The default is &#8220;cmd&#8221; + [algo name].</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-data-dir">
<code class="descname">--data_dir</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-data-dir" title="Permalink to this definition">¶</a></dt>
<dd><p><em>path</em>. Set the base save directory for this experiment or set of experiments. If none is given, the <code class="docutils literal"><span class="pre">DEFAULT_DATA_DIR</span></code> in <code class="docutils literal"><span class="pre">spinup/user_config.py</span></code> will be used.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-datestamp">
<code class="descname">--datestamp</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-datestamp" title="Permalink to this definition">¶</a></dt>
<dd><p><em>bool</em>. Include date and time in the name for the save directory of the experiment.</p>
</dd></dl>

</div>
</div>
<div class="section" id="where-results-are-saved">
<h3><a class="toc-backref" href="#id11">Where Results are Saved</a><a class="headerlink" href="#where-results-are-saved" title="Permalink to this headline">¶</a></h3>
<p>Results for a particular experiment (a single run of a configuration of hyperparameters) are stored in</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">data_dir</span><span class="o">/</span><span class="p">[</span><span class="n">outer_prefix</span><span class="p">]</span><span class="n">exp_name</span><span class="p">[</span><span class="n">suffix</span><span class="p">]</span><span class="o">/</span><span class="p">[</span><span class="n">inner_prefix</span><span class="p">]</span><span class="n">exp_name</span><span class="p">[</span><span class="n">suffix</span><span class="p">]</span><span class="n">_s</span><span class="p">[</span><span class="n">seed</span><span class="p">]</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">data_dir</span></code> is the value of the <code class="docutils literal"><span class="pre">--data_dir</span></code> flag (defaults to <code class="docutils literal"><span class="pre">DEFAULT_DATA_DIR</span></code> from <code class="docutils literal"><span class="pre">spinup/user_config.py</span></code> if <code class="docutils literal"><span class="pre">--data_dir</span></code> is not given),</li>
<li>the <code class="docutils literal"><span class="pre">outer_prefix</span></code> is a <code class="docutils literal"><span class="pre">YY-MM-DD_</span></code> timestamp if the <code class="docutils literal"><span class="pre">--datestamp</span></code> flag is raised, otherwise nothing,</li>
<li>the <code class="docutils literal"><span class="pre">inner_prefix</span></code> is a <code class="docutils literal"><span class="pre">YY-MM-DD_HH-MM-SS-</span></code> timestamp if the <code class="docutils literal"><span class="pre">--datestamp</span></code> flag is raised, otherwise nothing,</li>
<li>and <code class="docutils literal"><span class="pre">suffix</span></code> is a special string based on the experiment hyperparameters.</li>
</ul>
<div class="section" id="how-is-suffix-determined">
<h4><a class="toc-backref" href="#id12">How is Suffix Determined?</a><a class="headerlink" href="#how-is-suffix-determined" title="Permalink to this headline">¶</a></h4>
<p>Suffixes are only included if you run multiple experiments at once, and they only include references to hyperparameters that differ across experiments, except for random seed. The goal is to make sure that results for similar experiments (ones which share all params except seed) are grouped in the same folder.</p>
<p>Suffixes are constructed by combining <em>shorthands</em> for hyperparameters with their values, where a shorthand is either 1) constructed automatically from the hyperparameter name or 2) supplied by the user. The user can supply a shorthand by writing in square brackets after the kwarg flag.</p>
<p>For example, consider:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">spinup</span><span class="o">.</span><span class="n">run</span> <span class="n">ddpg</span> <span class="o">--</span><span class="n">env</span> <span class="n">Hopper</span><span class="o">-</span><span class="n">v2</span> <span class="o">--</span><span class="n">hid</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="mi">300</span><span class="p">]</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span> <span class="o">--</span><span class="n">act</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">tanh</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal"><span class="pre">--hid</span></code> flag is given a <strong>user-supplied shorthand</strong>, <code class="docutils literal"><span class="pre">h</span></code>. The <code class="docutils literal"><span class="pre">--act</span></code> flag is not given a shorthand by the user, so one will be constructed for it automatically.</p>
<p>The suffixes produced in this case are:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">_h128</span><span class="o">-</span><span class="mi">128</span><span class="n">_ac</span><span class="o">-</span><span class="n">actrelu</span>
<span class="n">_h128</span><span class="o">-</span><span class="mi">128</span><span class="n">_ac</span><span class="o">-</span><span class="n">acttanh</span>
<span class="n">_h300_ac</span><span class="o">-</span><span class="n">actrelu</span>
<span class="n">_h300_ac</span><span class="o">-</span><span class="n">acttanh</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal"><span class="pre">h</span></code> was given by the user. the <code class="docutils literal"><span class="pre">ac-act</span></code> shorthand was constructed from <code class="docutils literal"><span class="pre">ac_kwargs:activation</span></code> (the true name for the <code class="docutils literal"><span class="pre">act</span></code> flag).</p>
</div>
</div>
<div class="section" id="extra">
<h3><a class="toc-backref" href="#id13">Extra</a><a class="headerlink" href="#extra" title="Permalink to this headline">¶</a></h3>
<div class="admonition-you-don-t-actually-need-to-know-this-one admonition">
<p class="first admonition-title">You Don&#8217;t Actually Need to Know This One</p>
<p>Each individual algorithm is located in a file <code class="docutils literal"><span class="pre">spinup/algos/ALGO_NAME/ALGO_NAME.py</span></code>, and these files can be run directly from the command line with a limited set of arguments (some of which differ from what&#8217;s available to <code class="docutils literal"><span class="pre">spinup/run.py</span></code>). The command line support in the individual algorithm files is essentially vestigial, however, and this is <strong>not</strong> a recommended way to perform experiments.</p>
<p class="last">This documentation page will not describe those command line calls, and will <em>only</em> describe calls through <code class="docutils literal"><span class="pre">spinup/run.py</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="launching-from-scripts">
<h2><a class="toc-backref" href="#id14">Launching from Scripts</a><a class="headerlink" href="#launching-from-scripts" title="Permalink to this headline">¶</a></h2>
<p>Each algorithm is implemented as a python function, which can be imported directly from the <code class="docutils literal"><span class="pre">spinup</span></code> package, eg</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">spinup</span> <span class="k">import</span> <span class="n">ppo</span>
</pre></div>
</div>
<p>See the documentation page for each algorithm for a complete account of possible arguments. These methods can be used to set up specialized custom experiments, for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">spinup</span> <span class="kn">import</span> <span class="n">ppo</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">gym</span>

<span class="n">env_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;LunarLander-v2&#39;</span><span class="p">)</span>

<span class="n">ac_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hidden_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>

<span class="n">logger_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;path/to/output_dir&#39;</span><span class="p">,</span> <span class="n">exp_name</span><span class="o">=</span><span class="s1">&#39;experiment_name&#39;</span><span class="p">)</span>

<span class="n">ppo</span><span class="p">(</span><span class="n">env_fn</span><span class="o">=</span><span class="n">env_fn</span><span class="p">,</span> <span class="n">ac_kwargs</span><span class="o">=</span><span class="n">ac_kwargs</span><span class="p">,</span> <span class="n">steps_per_epoch</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">logger_kwargs</span><span class="o">=</span><span class="n">logger_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="using-experimentgrid">
<h3><a class="toc-backref" href="#id15">Using ExperimentGrid</a><a class="headerlink" href="#using-experimentgrid" title="Permalink to this headline">¶</a></h3>
<p>It&#8217;s often useful in machine learning research to run the same algorithm with many possible hyperparameters. Spinning Up ships with a simple tool for facilitating this, called <a class="reference external" href="../utils/run_utils.html#experimentgrid">ExperimentGrid</a>.</p>
<p>Consider the example in <code class="docutils literal"><span class="pre">spinup/examples/bench_ppo_cartpole.py</span></code>:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="kn">from</span> <span class="nn">spinup.utils.run_utils</span> <span class="kn">import</span> <span class="n">ExperimentGrid</span>
 <span class="kn">from</span> <span class="nn">spinup</span> <span class="kn">import</span> <span class="n">ppo</span>
 <span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>

 <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
     <span class="kn">import</span> <span class="nn">argparse</span>
     <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
     <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--cpu&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
     <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--num_runs&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
     <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

     <span class="n">eg</span> <span class="o">=</span> <span class="n">ExperimentGrid</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;ppo-bench&#39;</span><span class="p">)</span>
     <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;env_name&#39;</span><span class="p">,</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
     <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;seed&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span><span class="o">*</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">num_runs</span><span class="p">)])</span>
     <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;epochs&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
     <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;steps_per_epoch&#39;</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
     <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;ac_kwargs:hidden_sizes&#39;</span><span class="p">,</span> <span class="p">[(</span><span class="mi">32</span><span class="p">,),</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">)],</span> <span class="s1">&#39;hid&#39;</span><span class="p">)</span>
     <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s1">&#39;ac_kwargs:activation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">tf</span><span class="o">.</span><span class="n">tanh</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">],</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
     <span class="n">eg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ppo</span><span class="p">,</span> <span class="n">num_cpu</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">cpu</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>After making the ExperimentGrid object, parameters are added to it with</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">shorthand</span><span class="p">,</span> <span class="n">in_name</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">in_name</span></code> forces a parameter to appear in the experiment name, even if it has the same value across all experiments.</p>
<p>After all parameters have been added,</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">eg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">thunk</span><span class="p">,</span> <span class="o">**</span><span class="n">run_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>runs all experiments in the grid (one experiment per valid configuration), by providing the configurations as kwargs to the function <code class="docutils literal"><span class="pre">thunk</span></code>. <code class="docutils literal"><span class="pre">ExperimentGrid.run</span></code> uses a function named <a class="reference external" href="../utils/run_utils.html#spinup.utils.run_utils.call_experiment">call_experiment</a> to launch <code class="docutils literal"><span class="pre">thunk</span></code>, and <code class="docutils literal"><span class="pre">**run_kwargs</span></code> specify behaviors for <code class="docutils literal"><span class="pre">call_experiment</span></code>. See <a class="reference external" href="../utils/run_utils.html#experimentgrid">the documentation page</a> for details.</p>
<p>Except for the absence of shortcut kwargs (you can&#8217;t use <code class="docutils literal"><span class="pre">hid</span></code> for <code class="docutils literal"><span class="pre">ac_kwargs:hidden_sizes</span></code> in <code class="docutils literal"><span class="pre">ExperimentGrid</span></code>), the basic behavior of <code class="docutils literal"><span class="pre">ExperimentGrid</span></code> is the same as running things from the command line. (In fact, <code class="docutils literal"><span class="pre">spinup.run</span></code> uses an <code class="docutils literal"><span class="pre">ExperimentGrid</span></code> under the hood.)</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="saving_and_loading.html" class="btn btn-neutral float-right" title="Experiment Outputs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="algorithms.html" class="btn btn-neutral" title="Algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, OpenAI.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>